<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>PROF-SAFE24 Premium â€“ Painel PÃºblico</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- PWA / MANIFEST -->
<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#0a0014">

<!-- Ãcones padrÃ£o -->
<link rel="icon" type="image/png" sizes="192x192" href="/static/icons/icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/static/icons/icon-512.png">

<!-- Apple (iPhone / iPad) -->
<link rel="apple-touch-icon" sizes="180x180" href="/static/icons/icon-192.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Estilo -->
<link rel="stylesheet" href="/static/style.css">
</head>

<body>

<div class="container">
  <div class="card">
    <div class="header">
      <div class="title">ðŸ“¢ PROF-SAFE24 PREMIUM â€“ PAINEL PÃšBLICO</div>
      <div class="subtitle">Monitoramento em tempo real</div>
    </div>

    <div class="clock" id="clock">--:--:--</div>

    <div class="grid">
      <div class="box">
        <h3>Status da Sirene</h3>
        <div id="statusSirene" class="status normal">NORMAL</div>
      </div>

      <div class="box">
        <h3>Alertas Ativos</h3>
        <div id="alertasAtivos">0</div>
      </div>

      <div class="box">
        <h3>Total de Alertas</h3>
        <div id="totalAlertas">0</div>
      </div>

      <div class="box">
        <h3>Ãšltima AtualizaÃ§Ã£o</h3>
        <div id="ultimaAtualizacao">--</div>
      </div>
    </div>

    <div class="log">
      <h3>Ãšltimos Alertas</h3>
      <div id="listaAlertas">Aguardando alertas...</div>
    </div>
  </div>
</div>

<script>
// RelÃ³gio
setInterval(() => {
  const agora = new Date();
  document.getElementById("clock").innerText =
    agora.toLocaleTimeString("pt-BR");
}, 1000);

// AtualizaÃ§Ã£o (simples, sem quebrar sistema)
function atualizarPainel() {
  fetch("/status")
    .then(r => r.json())
    .then(d => {
      document.getElementById("statusSirene").innerText = d.sirene ? "ATIVA" : "NORMAL";
      document.getElementById("statusSirene").className =
        "status " + (d.sirene ? "ativa" : "normal");

      document.getElementById("alertasAtivos").innerText = d.alertas_ativos || 0;
      document.getElementById("totalAlertas").innerText = d.total_alertas || 0;
      document.getElementById("ultimaAtualizacao").innerText =
        new Date().toLocaleTimeString("pt-BR");

      document.getElementById("listaAlertas").innerHTML =
        (d.logs && d.logs.length)
        ? d.logs.map(l => `<div>ðŸš¨ ${l}</div>`).join("")
        : "Nenhum alerta no momento.";
    })
    .catch(() => {});
}

setInterval(atualizarPainel, 3000);
</script>

</body>
</html>
